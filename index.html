<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Тест: Анализ и визуализация данных</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Unbounded:wght@400;700;900&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --card: #1a1a26;
    --border: #2a2a3e;
    --accent: #7c3aed;
    --accent2: #06d6a0;
    --wrong: #ef4444;
    --text: #e2e8f0;
    --muted: #64748b;
    --correct-bg: #052e16;
    --wrong-bg: #2d0a0a;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px;
  }
  body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(ellipse at 20% 20%, #7c3aed22 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, #06d6a022 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

.container { max-width: 800px; width: 100%; position: relative; z-index: 1; }

/* HEADER */
header { text-align: center; padding: 40px 0 30px; }
header h1 {
font-family: 'Unbounded', sans-serif;
font-size: clamp(1.4rem, 4vw, 2.2rem);
font-weight: 900;
background: linear-gradient(135deg, #7c3aed, #06d6a0);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
letter-spacing: -0.02em;
line-height: 1.2;
}
header p { color: var(--muted); margin-top: 10px; font-size: 0.85rem; }

/* PROGRESS */
.progress-bar-wrap {
background: var(--border);
border-radius: 100px;
height: 6px;
margin-bottom: 8px;
overflow: hidden;
}
.progress-bar-fill {
height: 100%;
background: linear-gradient(90deg, #7c3aed, #06d6a0);
border-radius: 100px;
transition: width 0.4s ease;
}
.progress-text {
display: flex;
justify-content: space-between;
font-size: 0.75rem;
color: var(--muted);
margin-bottom: 24px;
}
.score-live { color: var(--accent2); font-weight: 700; }

/* QUESTION CARD */
.question-card {
background: var(--card);
border: 1px solid var(--border);
border-radius: 16px;
padding: 28px;
margin-bottom: 16px;
animation: slideIn 0.3s ease;
}
@keyframes slideIn {
from { opacity: 0; transform: translateY(16px); }
to   { opacity: 1; transform: translateY(0); }
}
.q-number {
font-size: 0.7rem;
color: var(--accent);
font-weight: 700;
letter-spacing: 0.1em;
text-transform: uppercase;
margin-bottom: 12px;
}
.q-text {
font-size: clamp(0.9rem, 2.5vw, 1.05rem);
line-height: 1.7;
color: var(--text);
margin-bottom: 24px;
font-family: 'JetBrains Mono', monospace;
}

/* OPTIONS */
.options { display: flex; flex-direction: column; gap: 10px; }
.option {
background: var(--surface);
border: 1.5px solid var(--border);
border-radius: 10px;
padding: 14px 18px;
cursor: pointer;
transition: all 0.18s ease;
font-family: 'JetBrains Mono', monospace;
font-size: 0.88rem;
color: var(--text);
text-align: left;
line-height: 1.5;
position: relative;
overflow: hidden;
}
.option::before {
content: '';
position: absolute;
left: 0; top: 0; bottom: 0;
width: 3px;
background: var(--accent);
opacity: 0;
transition: opacity 0.2s;
}
.option:hover:not(:disabled) {
border-color: var(--accent);
background: #1e1e30;
transform: translateX(4px);
}
.option:hover:not(:disabled)::before { opacity: 1; }
.option:disabled { cursor: default; }

.option.correct {
background: var(--correct-bg);
border-color: var(--accent2);
color: var(--accent2);
transform: translateX(4px);
}
.option.correct::before { background: var(--accent2); opacity: 1; }
.option.wrong {
background: var(--wrong-bg);
border-color: var(--wrong);
color: var(--wrong);
}
.option.wrong::before { background: var(--wrong); opacity: 1; }
.option.disabled-grey {
opacity: 0.35;
}

/* FEEDBACK */
.feedback {
margin-top: 16px;
padding: 14px 18px;
border-radius: 10px;
font-size: 0.85rem;
font-weight: 700;
display: none;
align-items: center;
gap: 10px;
animation: popIn 0.25s ease;
}
@keyframes popIn {
from { transform: scale(0.95); opacity: 0; }
to   { transform: scale(1); opacity: 1; }
}
.feedback.show { display: flex; }
.feedback.correct-fb {
background: var(--correct-bg);
border: 1px solid var(--accent2);
color: var(--accent2);
}
.feedback.wrong-fb {
background: var(--wrong-bg);
border: 1px solid var(--wrong);
color: var(--wrong);
}
.feedback-icon { font-size: 1.3rem; flex-shrink: 0; }

/* NEXT BUTTON */
.btn-next {
margin-top: 20px;
width: 100%;
padding: 16px;
background: linear-gradient(135deg, var(--accent), #9f5ff5);
border: none;
border-radius: 10px;
color: #fff;
font-family: 'Unbounded', sans-serif;
font-size: 0.85rem;
font-weight: 700;
cursor: pointer;
display: none;
transition: opacity 0.2s, transform 0.2s;
letter-spacing: 0.05em;
}
.btn-next.show { display: block; }
.btn-next:hover { opacity: 0.9; transform: translateY(-2px); }

/* RESULT SCREEN */
.result-screen {
display: none;
text-align: center;
padding: 60px 20px;
animation: slideIn 0.4s ease;
}
.result-screen.show { display: block; }
.result-circle {
width: 160px; height: 160px;
border-radius: 50%;
background: conic-gradient(var(--accent2) var(--pct), var(--border) 0);
display: flex; align-items: center; justify-content: center;
margin: 0 auto 30px;
position: relative;
}
.result-circle::after {
content: '';
position: absolute;
width: 120px; height: 120px;
border-radius: 50%;
background: var(--card);
}
.result-score {
position: relative; z-index: 1;
font-family: 'Unbounded', sans-serif;
font-size: 2rem;
font-weight: 900;
color: var(--accent2);
}
.result-title {
font-family: 'Unbounded', sans-serif;
font-size: 1.5rem;
font-weight: 900;
margin-bottom: 12px;
background: linear-gradient(135deg, #7c3aed, #06d6a0);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
}
.result-sub { color: var(--muted); font-size: 0.9rem; margin-bottom: 30px; line-height: 1.7; }
.btn-restart {
padding: 16px 40px;
background: linear-gradient(135deg, var(--accent), #06d6a0);
border: none; border-radius: 10px;
color: #fff;
font-family: 'Unbounded', sans-serif;
font-size: 0.85rem;
font-weight: 700;
cursor: pointer;
letter-spacing: 0.05em;
transition: opacity 0.2s;
}
.btn-restart:hover { opacity: 0.85; }

/* QUIZ AREA */
#quiz-area { display: block; }
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>АНАЛИЗ И ВИЗУАЛИЗАЦИЯ ДАННЫХ</h1>
    <p>Тест</p>
  </header>

  <div id="quiz-area">
    <div class="progress-bar-wrap">
      <div class="progress-bar-fill" id="progress-fill" style="width:0%"></div>
    </div>
    <div class="progress-text">
      <span id="progress-label">Вопрос 1 из 109</span>
      <span class="score-live" id="score-label">✓ 0</span>
    </div>

    <div class="question-card" id="question-card">
      <div class="q-number" id="q-number">ВОПРОС 01</div>
      <div class="q-text" id="q-text"></div>
      <div class="options" id="options"></div>
      <div class="feedback" id="feedback">
        <span class="feedback-icon" id="feedback-icon"></span>
        <span id="feedback-text"></span>
      </div>
      <button class="btn-next" id="btn-next" onclick="nextQuestion()">
        Следующий вопрос →
      </button>
    </div>
  </div>

  <div class="result-screen" id="result-screen">
    <div class="result-circle" id="result-circle">
      <div class="result-score" id="result-score"></div>
    </div>
    <div class="result-title" id="result-title"></div>
    <div class="result-sub" id="result-sub"></div>
    <button class="btn-restart" onclick="restartQuiz()">↺ Пройти заново</button>
  </div>
</div>

<script>
const questions = [
  // КОМПЕТЕНЦИЯ УК-1.1 (вопросы 1-13)
  { q: "1. Что является первым шагом в методике сбора информации для аналитической задачи?", opts: ["Построение графиков и дашборда", "Определение цели исследования и формулировка вопроса (что и зачем измеряем)", "Обучение модели на исторических данных", "Автоматическая очистка пропусков"], ans: 1 },
  { q: "2. Что в методологии анализа данных принято считать данными в их исходном, базовом понимании?", opts: ["Готовые аналитические отчёты и интерпретации", "Набор значений, измерений или записей, фиксирующих характеристики объектов, событий или процессов", "Визуальные представления информации: графики, диаграммы", "Информацию из публичных источников"], ans: 1 },
  { q: "3. Какие элементы обязательно входят в план сбора данных? (Выберите все верные)", opts: ["Определение целевой аудитории/объекта наблюдения", "Описание источников данных и способа получения", "Правила проверки качества", "Выбор цветовой схемы визуализаций", "Описание периода наблюдения и частоты обновления"], ans: 0, multi: [0,1,2,4] },
  { q: "4. В анализе данных под признаком (feature) понимают:", opts: ["Отдельный объект анализа", "Наблюдаемую или вычисляемую характеристику объекта, используемую как входная переменная", "Алгоритм или статистическую модель", "Визуальный компонент отчёта"], ans: 1 },
  { q: "5а. Какой вопрос соответствует описательной аналитике (Descriptive Analytics)?", opts: ["«Почему в ноябре упала прибыль?»", "«Что делать, чтобы снизить отток?»", "«Сколько клиентов уйдёт в следующем месяце?»", "«Как распределились продажи по категориям за квартал?»"], ans: 3 },
  { q: "5б. Какой вопрос соответствует диагностической аналитике (Diagnostic Analytics)?", opts: ["«Почему в ноябре упала прибыль?»", "«Что делать, чтобы снизить отток?»", "«Сколько клиентов уйдёт в следующем месяце?»", "«Как распределились продажи по категориям?»"], ans: 0 },
  { q: "5в. Какой вопрос соответствует прогнозной аналитике (Predictive Analytics)?", opts: ["«Почему в ноябре упала прибыль?»", "«Что делать, чтобы снизить отток?»", "«Сколько клиентов уйдёт в следующем месяце?»", "«Как распределились продажи?»"], ans: 2 },
  { q: "5г. Какой вопрос соответствует предписывающей аналитике (Prescriptive Analytics)?", opts: ["«Почему в ноябре упала прибыль?»", "«Что делать, чтобы снизить отток?»", "«Сколько клиентов уйдёт в следующем месяце?»", "«Как распределились продажи?»"], ans: 1 },
  { q: "6. Почему важно учитывать контекст сбора данных (период, методику, изменения в процессах)?", opts: ["Чтобы улучшить визуальное оформление отчёта", "Чтобы снизить риск неверной интерпретации из-за смещений и смены методологии", "Чтобы ускорить работу дашборда", "Потому что большой объём данных гарантирует корректность выводов"], ans: 1 },
  { q: "7. В табличном наборе данных (DataFrame) что называют наблюдением (observation)?", opts: ["Столбец с признаком", "Одну строку, соответствующую одному объекту/событию", "Модель машинного обучения", "График распределения признака"], ans: 1 },
  { q: "8. Как корректнее всего определить целевую переменную (target) в задаче обучения с учителем?", opts: ["Любой категориальный признак", "Переменная, которую модель должна предсказать (выход)", "Любой числовой признак после нормализации", "Идентификатор строки (index)"], ans: 1 },
  { q: "9. Компания оценивает удовлетворённость по отзывам только от пользователей, написавших в поддержку. Какой риск наиболее типичен?", opts: ["Риск нарушения нормализации данных", "Риск смещения выборки (selection bias)", "Риск переобучения модели", "Риск увеличения точности (accuracy)"], ans: 1 },
  { q: "10. Что является корректной формулировкой цели аналитического исследования?", opts: ["«Сделать красивый дашборд»", "«Понять всё про пользователей»", "«Оценить влияние скидки 10% на конверсию за 4 недели»", "«Собрать побольше данных»"], ans: 2 },
  { q: "11. Установите соответствие: Опрос пользователей — какой риск?", opts: ["Субъективность эксперта", "Самоотбор и искажения ответов", "Смена методики", "Потери событий"], ans: 1 },
  { q: "12. Какой тезис описывает принцип воспроизводимости?", opts: ["Результат понравился заказчику", "При тех же данных и шагах получается тот же вывод", "Данных много", "Использовалась сложная модель"], ans: 1 },
  { q: "13. Почему опасно делать обобщения без сегментации?", opts: ["Так нельзя в Pandas", "Эффект агрегирования/парадокс Симпсона", "Среднее всегда равно медиане", "Визуализация станет сложнее"], ans: 1 },

  // КОМПЕТЕНЦИЯ УК-1.2 (вопросы 14-25)
  { q: "14. Какая последовательность этапов наиболее соответствует жизненному циклу анализа данных?", opts: ["Сбор → Анализ → Визуализация → Очистка", "Сбор → Подготовка и очистка → Анализ → Интерпретация", "Формулирование гипотезы → Построение модели → Сбор данных", "Сбор → Формулирование выводов → Подготовка данных"], ans: 1 },
  { q: "15. Установите последовательность первичной обработки данных: 1) Очистка данных, 2) Удаление дубликатов, 3) Анализ пропусков, 4) Проверка типов данных, 5) Финальная проверка качества.", opts: ["1→2→3→4→5", "4→3→2→1→5", "3→4→2→1→5", "2→3→4→1→5"], ans: 1 },
  { q: "16. Установите последовательность этапов жизненного цикла аналитического проекта.", opts: ["а→б→в→г→д", "а→б→д→в→г", "б→а→в→г→д", "в→б→а→г→д"], ans: 1 },
  { q: "17а. Для какой задачи лучше всего подходит гистограмма (Histogram)?", opts: ["Сравнение величин по категориям", "Анализ распределения непрерывного числового признака", "Исследование взаимосвязи двух переменных", "Отображение динамики во времени"], ans: 1 },
  { q: "17б. Для какой задачи лучше всего подходит столбчатая диаграмма (Bar Chart)?", opts: ["Сравнение величин по дискретным категориям", "Анализ распределения числового признака", "Исследование взаимосвязи двух переменных", "Отображение динамики во времени"], ans: 0 },
  { q: "17в. Для какой задачи лучше всего подходит линейный график (Line Chart)?", opts: ["Сравнение величин по категориям", "Анализ распределения", "Исследование взаимосвязи двух переменных", "Отображение динамики показателя во времени"], ans: 3 },
  { q: "17г. Для какой задачи лучше всего подходит диаграмма рассеяния (Scatter Plot)?", opts: ["Сравнение величин по категориям", "Анализ распределения", "Исследование взаимосвязи двух непрерывных переменных", "Отображение динамики во времени"], ans: 2 },
  { q: "18. Для быстрого сравнения выручки по 15 категориям какой тип визуализации наиболее эффективен?", opts: ["Круговая диаграмма", "Столбчатая диаграмма с сортировкой по убыванию", "Диаграмма рассеяния", "Гистограмма"], ans: 1 },
  { q: "19. Установите последовательность для получения среднего чека по регионам: 1) Группировка, 2) Расчёт среднего, 3) Аудит данных, 4) Анализ.", opts: ["1→2→3→4", "3→1→2→4", "2→1→3→4", "4→3→2→1"], ans: 1 },
  { q: "20. В столбце «Сумма покупки» обнаружены выбросы. Какие шаги предпринять? (Выберите все верные)", opts: ["Проверить техническую корректность", "Изучить бизнес-контекст", "Немедленно исключить по IQR", "Сравнить результаты с выбросами и без"], ans: 0, multi: [0,1,3] },
  { q: "21. При подключении стороннего дата-сета что обязательно проверить? (Выберите все верные)", opts: ["Происхождение и методологию", "Временные характеристики", "Наличие определений метрик", "Визуальное оформление", "Наличие систематических искажений"], ans: 0, multi: [0,1,2,4] },
  { q: "22. После обучения: accuracy train=0.95, test=0.65. Какой шаг корректен?", opts: ["Принять результаты", "Провести диагностику, упростить модель", "Улучшить визуализацию", "Игнорировать тестовую выборку"], ans: 1 },
  { q: "23. Какие два утверждения верны для ситуации accuracy train=0.94, test=0.62?", opts: ["Модель имеет высокую обобщающую способность", "Это признак переобучения", "Следует использовать кросс-валидацию", "Метрики precision не нужны"], ans: 1, multi: [1,2] },
  { q: "24а. Какой результат получается на этапе формулировки бизнес-задачи?", opts: ["Метрики качества", "Данные приведены к согласованным типам", "Графики и дашборды", "Исходный набор данных", "Чётко сформулированы бизнес-вопросы и KPI"], ans: 4 },
  { q: "24б. Какой результат получается на этапе извлечения и консолидации данных?", opts: ["Метрики качества", "Данные приведены к согласованным типам", "Графики и дашборды", "Сформирован исходный набор данных", "Бизнес-вопросы и KPI"], ans: 3 },
  { q: "24в. Какой результат получается на этапе предобработки и очистки данных?", opts: ["Метрики качества", "Данные приведены к согласованным типам, обработаны пропуски", "Графики и дашборды", "Исходный набор данных", "Бизнес-вопросы и KPI"], ans: 1 },
  { q: "24г. Какой результат получается на этапе аналитической обработки и визуализации?", opts: ["Метрики качества", "Данные приведены к согласованным типам", "Построены графики, выявлены закономерности", "Исходный набор данных", "Бизнес-вопросы и KPI"], ans: 2 },
  { q: "24д. Какой результат получается на этапе оценки и валидации результатов?", opts: ["Рассчитаны метрики качества, проверено отсутствие переобучения", "Данные приведены к согласованным типам", "Графики и дашборды", "Исходный набор данных", "Бизнес-вопросы и KPI"], ans: 0 },
  { q: "25. Вы сравнили метрику в CRM и BI — расхождение 12%. Какие проверки нужны? (Выберите все верные)", opts: ["Проверить определение 'заказ'", "Проверить период и часовой пояс", "Принять BI как истину", "Проверить фильтры", "Проверить актуальность"], ans: 0, multi: [0,1,3,4] },

  // КОМПЕТЕНЦИЯ УК-1.3 (вопросы 26-30)
  { q: "26. Что методически правильнее при работе с несколькими источниками с разными определениями?", opts: ["Усреднить значения", "Зафиксировать определения и описать преобразование", "Использовать источник с красивыми данными", "Игнорировать расхождения"], ans: 1 },
  { q: "27а. Что фиксирует протокол обработки данных?", opts: ["Изменения версий с датами", "Связь гипотез с признаками", "Какие преобразования и по каким правилам сделаны", "Границы системы"], ans: 2 },
  { q: "27б. Что фиксирует журнал изменений?", opts: ["Изменения версий данных/метрик с датами и причинами", "Связь гипотез с признаками", "Правила преобразований", "Границы системы"], ans: 0 },
  { q: "27в. Что содержит матрица гипотез?", opts: ["Изменения версий данных", "Связь гипотез с признаками/источниками", "Правила преобразований", "Границы системы"], ans: 1 },
  { q: "27г. Что описывает карта стейкхолдеров?", opts: ["Изменения версий данных", "Связь гипотез с признаками", "Правила преобразований", "Границы системы, заинтересованные стороны"], ans: 3 },
  { q: "28. Если внешний датасет обновляется, какова корректная практика?", opts: ["Всегда брать последнюю версию", "Зафиксировать версию/дату среза", "Не использовать внешние данные", "Использовать разные версии"], ans: 1 },
  { q: "29. Что является корректной практикой при удалении данных в ходе очистки?", opts: ["Удалять всё без фиксации", "Заранее определить критерии и документировать", "Удалять только в тестовой выборке", "Удалять до проверки качества"], ans: 1 },
  { q: "30. Как подтвердить, что результат анализа не случаен?", opts: ["Построить больше графиков", "Повторить анализ с разными допущениями", "Увеличить количество строк дублированием", "Исключить все данные с пропусками"], ans: 1 },

  // КОМПЕТЕНЦИЯ ОПК-2.1 (вопросы 31-36)
  { q: "31. Какой класс ПО применяют для управленческой отчётности?", opts: ["BI-платформы", "IDE для разработки", "Системы контроля версий", "Редакторы изображений"], ans: 0 },
  { q: "32. Какая система отвечает за учёт товаров и складских остатков?", opts: ["ERP-система", "CRM-система", "BI-платформа", "СЭД"], ans: 0 },
  { q: "33. Какие источники подключают к BI для аналитики? (Выберите все верные)", opts: ["CRM/ERP", "Web-аналитика", "Хранилище данных", "Плейлист в музыкальном сервисе", "Служба поддержки"], ans: 0, multi: [0,1,2,4] },
  { q: "34. Какова роль API-интеграции?", opts: ["Обмен данными по контракту", "Сохранение файлов на диск", "Дизайн интерфейса", "Печать документов"], ans: 0 },
  { q: "35. Для чего предназначена BI-платформа?", opts: ["Управление лидами", "Дашборды, KPI, аналитические отчёты", "Учёт склада", "Обработка обращений"], ans: 1 },
  { q: "36. Какая практика наиболее корректна в бизнес-аналитике?", opts: ["Считать метрики 'как получится'", "Фиксировать определения метрик и источники", "Использовать разные формулы в каждом отчёте", "Никогда не обновлять данные"], ans: 1 },

  // КОМПЕТЕНЦИЯ ОПК-2.2 (вопросы 37-48)
  { q: "37. При выборе BI для устаревшей инфраструктуры важнейший критерий?", opts: ["Совместимость и минимальные требования", "Сложная анимация", "Лидерство в рейтингах", "Встроенные функции ML"], ans: 0 },
  { q: "38. Какой критерий обеспечивает работу при росте числа пользователей?", opts: ["Масштабируемость", "Резервное копирование", "Поддержка коннекторов", "Наличие в реестре РФ"], ans: 0 },
  { q: "39. Ситуация: отечественная BI дороже, но с поддержкой ФЗ-152. Что выбрать?", opts: ["Зарубежную, дешевле", "Отечественную, снижает риски", "Оба решения", "Отказаться от BI"], ans: 1 },
  { q: "40. Почему важна документация при выборе ПО?", opts: ["Для красивого дизайна", "Ускорить внедрение и снизить зависимость", "По ГОСТу", "Увеличить отчётность"], ans: 1 },
  { q: "41. Какие действия снижают риски при выборе ПО? (Выберите все верные)", opts: ["Проверка сообщества", "Оценка планов вендора", "Выбор по демо-видео", "Тестирование PoC", "Игнорирование отзывов"], ans: 0, multi: [0,1,3] },
  { q: "42. Что использовать для аналитической витрины с контролем доступа?", opts: ["Excel на сетевом диске", "CSV в облаке", "Серверную СУБД", "Хранение в BI"], ans: 2 },
  { q: "43. При политике импортозамещения что нужно проверить?", opts: ["Наличие в реестре РФ", "Количество графиков", "Место в рейтингах", "Личные предпочтения"], ans: 0 },
  { q: "44. Какие критерии ключевые для крупного предприятия? (Выберите все верные)", opts: ["Интеграция", "TCO", "Безопасность и RBAC", "Эстетика UI", "Масштабируемость"], ans: 0, multi: [0,1,2,4] },
  { q: "45. Установите последовательность этапов выбора BI: 1) Анализ рынка, 2) Формулирование требований, 3) Пилот, 4) Решение.", opts: ["1→2→3→4", "2→1→3→4", "3→2→1→4", "2→3→1→4"], ans: 1 },
  { q: "46. Для конфиденциальных данных предпочтительный вариант развёртывания?", opts: ["Облачное решение", "Локальное решение"], ans: 1 },
  { q: "47. Установите последовательность этапов методологии выбора BI.", opts: ["1→2→3→4", "2→1→3→4", "3→2→1→4", "2→3→1→4"], ans: 1 },
  { q: "48. Соотнесите сценарий и вариант развёртывания: 1) Гибкость, 2) Конфиденциальность, 3) Нет DevOps.", opts: ["1-облако, 2-on-premise, 3-облако", "1-on-premise, 2-облако, 3-on-premise", "1-облако, 2-облако, 3-on-premise", "1-on-premise, 2-on-premise, 3-облако"], ans: 0 },

  // КОМПЕТЕНЦИЯ ОПК-2.3 (вопросы 49-60)
  { q: "49. Установите последовательность проектирования дашборда: 1) Анализ потребностей, 2) KPI, 3) Логическая модель, 4) Интерфейс, 5) Прототип.", opts: ["1→2→4→3→5", "1→2→3→4→5", "2→1→3→4→5", "3→1→2→4→5"], ans: 1 },
  { q: "50. Что означает «публикация дашборда» в корпоративной среде?", opts: ["Вывод на печать", "Размещение без прав доступа", "Развёртывание с настройкой ролей и расписания", "Сохранение на локальном ПК"], ans: 2 },
  { q: "51. Для отчёта из Excel и CRM какие источники нужны? (Выберите все верные)", opts: ["CSV/Excel", "Реляционные БД", "ERP-система", "PNG/растровые файлы", "Облачные API"], ans: 0, multi: [0,1,2,4] },
  { q: "52. Что такое матрица дашборда?", opts: ["Таблица для оценки ML-модели", "Документ с KPI, визуализациями и ролями", "Математический объект", "Документ о визуальном стиле"], ans: 1 },
  { q: "53. Что такое drill-down?", opts: ["Масштабирование интерфейса", "Иерархическая навигация от общего к детальному", "Сброс фильтров", "Смена темы"], ans: 1 },
  { q: "54. Цель навигационной структуры в дашборде?", opts: ["Повышение визуальной плотности", "Логическая организация информации", "Ограничение видимости", "Замена KPI на текст"], ans: 1 },
  { q: "55. Стандарт для отображения динамики во времени?", opts: ["Линейный график", "Круговая диаграмма", "Диаграмма Санкей", "Таблица"], ans: 0 },
  { q: "56. Что относится к настройке доступа в BI? (Выберите все верные)", opts: ["RBAC", "RLS", "Выбор цветовой темы", "Настройка расписания"], ans: 0, multi: [0,1] },
  { q: "57. Цель вычисляемых полей (measures) в BI?", opts: ["Безопасность", "Динамический расчёт метрик", "Замена источников данных", "Очистка данных"], ans: 1 },
  { q: "58. Для чего используется водопадная диаграмма?", opts: ["Динамика во времени", "Потоки между этапами", "Декомпозиция изменения показателя", "Сравнение распределений"], ans: 2 },
  { q: "59. Что включается в матрицу дашборда? (Выберите все верные)", opts: ["Спецификация метрик", "Анализ пользователей", "Модель разрезов", "Дизайн-гайдлайн", "Спецификация источников"], ans: 0, multi: [0,1,2,4] },
  { q: "60. Какой механизм обеспечивает видимость только своих данных?", opts: ["Row-Level Security", "Автоматизация", "Drill-down", "Меры"], ans: 0 },

  // КОМПЕТЕНЦИЯ ОПК-6.1 (вопросы 61-81)
  { q: "61. Шкала без естественного порядка (пол, город) называется __________.", opts: ["номинальной", "порядковой", "интервальной", "относительной"], ans: 0 },
  { q: "62. Какие показатели — меры центральной тенденции? (Выберите все верные)", opts: ["Медиана", "Среднее", "Дисперсия", "Мода", "IQR"], ans: 0, multi: [0,1,3] },
  { q: "63. Корреляция X и Y статистически значима. Что верно?", opts: ["X вызывает Y", "Согласованное изменение, но не причина", "Данные без ошибок", "X точно предсказывает Y"], ans: 1 },
  { q: "64. Таблица с TP, FP, FN, TN называется __________.", opts: ["матрицей ошибок", "таблицей сопряжённости", "корреляционной матрицей", "таблицей ковариаций"], ans: 0 },
  { q: "65. Медиана набора 12, 15, 15, 16, 100?", opts: ["12", "15", "16", "100"], ans: 1 },
  { q: "66. Команда для загрузки CSV в Pandas?", opts: ["pd.open_csv()", "pd.read_csv()", "df.load_csv()", "pd.import_csv()"], ans: 1 },
  { q: "67. Что делает df.groupby('region')['revenue'].sum()?", opts: ["Сортирует", "Сумму по регионам", "Удаляет пропуски", "Объединяет"], ans: 1 },
  { q: "68. df.shape возвращает?", opts: ["Названия столбцов", "Количество пропусков", "(число строк, число столбцов)", "Типы данных"], ans: 2 },
  { q: "69. Какая команда завершает построение графика в Matplotlib?", opts: ["plt.render()", "plt.show()", "plt.draw_all()", "plt.open()"], ans: 1 },
  { q: "70. Что подходит для анализа распределения?", opts: ["plt.hist()", "plt.plot()", "plt.pie()", "plt.imshow()"], ans: 0 },
  { q: "71. df.dtypes показывает?", opts: ["Первые 5 строк", "Типы данных столбцов", "Количество пропусков", "Число уникальных значений"], ans: 1 },
  { q: "72. Как получить названия столбцов?", opts: ["df.columns", "df.rows", "df.header()", "df.colnames()"], ans: 0 },
  { q: "73. Что делает df.dropna()?", opts: ["Маска пропусков", "Удаляет строки с пропусками", "Заполняет пропуски", "Удаляет дубликаты"], ans: 1 },
  { q: "74. Чтобы подписать ось X, используют plt.______()", opts: ["xlabel", "title", "ylabel", "legend"], ans: 0 },
  { q: "75. Как из '1 250,50' получить число?", opts: ["astype(int)", "удалить столбец", "заменить пробелы и запятые, затем float", "fillna(0)"], ans: 2 },
  { q: "76. После merge появилось много NaN. Первое действие?", opts: ["Заменить на 0", "Проверить ключи и совпадения", "Удалить строки с NaN", "Игнорировать"], ans: 1 },
  { q: "77. Последовательность построения графика: 1) Данные, 2) График, 3) Подписи, 4) Вывод.", opts: ["1→2→3→4", "2→1→3→4", "1→3→2→4", "3→1→2→4"], ans: 0 },
  { q: "78. Метод для реляционного соединения в Pandas?", opts: ["concat", "merge", "join", "append"], ans: 1 },
  { q: "79. Как построить горизонтальную столбчатую?", opts: ["plt.barh()", "plt.hbar()", "plt.bar(horizontal=True)", "plt.hist()"], ans: 0 },
  { q: "80. Что улучшает читаемость графика?", opts: ["plt.grid(True)", "plt.map()", "plt.axis()", "plt.mesh()"], ans: 0 },
  { q: "81. Что делать с NaN перед обучением sklearn?", opts: ["Преобразовать в строку", "Удалить целевую переменную", "Обработать пропуски до обучения", "Игнорировать"], ans: 2 },

  // КОМПЕТЕНЦИЯ ОПК-6.2 (вопросы 82-105)
  { q: "82. Прогнозирование стоимости доставки — это задача:", opts: ["Регрессии", "Классификации", "Кластеризации", "Ранжирования"], ans: 0 },
  { q: "83. Основная цель кросс-валидации?", opts: ["Увеличить выборку", "Оценка обобщающей способности", "Повысить производительность", "Упростить интерпретацию"], ans: 1 },
  { q: "84. Стандартные шаги предобработки для ML? (Выберите все верные)", opts: ["Дедупликация", "Обработка пропусков", "Масштабирование", "Подбор цветов", "Кодирование категорий"], ans: 0, multi: [0,1,2,4] },
  { q: "85. 3% пропусков в «Возрасте». Что делать?", opts: ["Удалить все с пропусками", "Заполнить медианой по группе и проверить", "Заменить на 0", "Анализ без изменений"], ans: 1 },
  { q: "86. Как решать проблему дублирующихся записей?", opts: ["Удаление/объединение дубликатов", "Валидация по правилам", "Импутация", "Масштабирование"], ans: 0 },
  { q: "87. Подход к обработке выбросов?", opts: ["Удалить все", "Исследовать происхождение", "Продолжить без изменений", "Исключить признак"], ans: 1 },
  { q: "88. Accuracy при TP=40, FP=10, FN=5, TN=45?", opts: ["0,70", "0,80", "0,85", "0,90"], ans: 2 },
  { q: "89. Что такое KPI?", opts: ["Количественный показатель цели", "Вычисляемое поле", "Модель данных", "ETL-процесс"], ans: 0 },
  { q: "90. Что содержит фактовая таблица в звёздной схеме?", opts: ["Описательные атрибуты", "Численные показатели и внешние ключи", "Классификаторы", "Только даты"], ans: 1 },
  { q: "91. Последовательность подготовки к обучению: 1) Разделить, 2) Обработать пропуски, 3) X и y, 4) Обучить, 5) Оценить.", opts: ["1→2→3→4→5", "2→3→1→4→5", "3→2→1→4→5", "2→1→3→4→5"], ans: 1 },
  { q: "92. Прогноз стоимости доставки (число) — это?", opts: ["Классификация", "Регрессия", "Кластеризация", "Ранжирование"], ans: 1 },
  { q: "93. KMeans — это обучение?", opts: ["С учителем", "Без учителя", "С подкреплением", "Глубокое"], ans: 1 },
  { q: "94. Признаки переобучения? (Выберите все верные)", opts: ["Train > test", "Train = test высокое", "Test падает при усложнении", "Разные результаты на кросс-валидации"], ans: 0, multi: [0,2,3] },
  { q: "95. Что такое недообучение?", opts: ["Train высокое, test низкое", "Низкое и train, и test", "Test выше train", "Нет гиперпараметров"], ans: 1 },
  { q: "96. Pipeline в scikit-learn?", opts: ["Хранит данные", "Объединяет предобработку и модель", "Тип графика", "Рисует дашборды"], ans: 1 },
  { q: "97. Что измеряет Precision?", opts: ["Долю верных ответов", "Среднюю абсолютную ошибку", "TP / (TP + FP)", "TP / (TP + FN)"], ans: 2 },
  { q: "98. Последовательность: 1) Разделить, 2) Признаки, 3) X и y, 4) Обучить, 5) Оценить.", opts: ["1→2→3→4→5", "2→3→1→4→5", "3→2→1→4→5", "2→1→3→4→5"], ans: 1 },
  { q: "99. Train высокое, test низкое. Что делать?", opts: ["Усложнить модель", "Проверить утечки, упростить", "Удалить test", "Построить круговую"], ans: 1 },
  { q: "100. Как избежать утечки при масштабировании?", opts: ["На всём датасете до разделения", "После разделения, обучать на train", "Только на test", "Не делать"], ans: 1 },
  { q: "101. Минимум для сравнения двух моделей?", opts: ["Train-метрика", "Одинаковое разбиение и одна метрика на test", "Скорость работы", "Красота графиков"], ans: 1 },
  { q: "102. Train высокое, test низкое. Следующий шаг?", opts: ["Усложнить", "Кросс-валидация и упрощение", "Удалить test", "Заменить scatter на pie"], ans: 1 },
  { q: "103. В задаче 'купит ли клиент' признаки и цель?", opts: ["X = bought, y = age", "X = age, city, visits, y = bought", "X = все, y не нужен", "X = age, y = city"], ans: 1 },
  { q: "104. Какой алгоритм для кластеризации клиентов без меток?", opts: ["KMeans", "LogisticRegression", "LinearRegression", "DecisionTree"], ans: 0 },
  { q: "105. Есть данные: сумма, частота, чек, давность. Нужны группы. Какой алгоритм?", opts: ["KMeans", "LogisticRegression", "LinearRegression", "DecisionTree"], ans: 0 },

  // КОМПЕТЕНЦИЯ ОПК-6.3 (вопросы 106-109)
  { q: "106. Установите соответствие: 1) Теоретическая подготовка, 2) Экспериментальная, 3) Интерпретация.", opts: ["1-а (анализ решений), 2-б (реализация), 3-в (оценка)", "1-б, 2-в, 3-а", "1-в, 2-а, 3-б", "1-а, 2-в, 3-б"], ans: 0 },
  { q: "107. Как объективно сравнить две модели?", opts: ["Разные тестовые выборки", "Одна предобработка и единая тестовая выборка", "По числу параметров", "По времени обучения"], ans: 1 },
  { q: "108. Последовательность исследования: 1) Подготовка данных, 2) Формулировка вопроса, 3) Интерпретация, 4) Выбор метода, 5) Расчёты.", opts: ["1→2→4→5→3", "2→1→4→5→3", "2→4→1→5→3", "1→4→2→5→3"], ans: 1 },
  { q: "109. Этичное исследование? (Выберите все верные)", opts: ["Прозрачное документирование", "Скрытие неудобных результатов", "Учёт побочных эффектов", "Использование данных по назначению", "Преувеличение значимости"], ans: 0, multi: [0,2,3] }
];


let current = 0;
let score = 0;
let answered = false;

function renderQuestion() {
  const q = questions[current];
  answered = false;

  document.getElementById('q-number').textContent = `ВОПРОС ${String(current+1).padStart(2,'0')}`;
  document.getElementById('q-text').textContent = q.q;
  document.getElementById('progress-label').textContent = `Вопрос ${current+1} из ${questions.length}`;
  document.getElementById('score-label').textContent = `✓ ${score}`;
  document.getElementById('progress-fill').style.width = `${((current) / questions.length) * 100}%`;

  const feedback = document.getElementById('feedback');
  feedback.className = 'feedback';
  document.getElementById('btn-next').className = 'btn-next';

  const optionsEl = document.getElementById('options');
  optionsEl.innerHTML = '';

  q.opts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'option';
    btn.textContent = opt;
    btn.onclick = () => selectAnswer(i);
    optionsEl.appendChild(btn);
  });
}

function selectAnswer(chosen) {
  if (answered) return;
  answered = true;

  const q = questions[current];
  const opts = document.querySelectorAll('.option');
  const feedback = document.getElementById('feedback');
  const icon = document.getElementById('feedback-icon');
  const text = document.getElementById('feedback-text');
  const btn = document.getElementById('btn-next');

  opts.forEach(o => o.disabled = true);

  let isCorrect = false;
  let correctAnswerText = '';

  if (Array.isArray(q.multi)) {
    isCorrect = (chosen === q.multi[0]);
    correctAnswerText = q.opts[q.multi[0]];
  } else {
    isCorrect = (chosen === q.ans);
    correctAnswerText = q.opts[q.ans];
  }

  if (isCorrect) {
    score++;
    opts[chosen].classList.add('correct');
    feedback.className = 'feedback correct-fb show';
    icon.textContent = '✓';
    text.textContent = 'Правильно!';
  } else {
    opts[chosen].classList.add('wrong');
    let correctIndex = Array.isArray(q.multi) ? q.multi[0] : q.ans;
    opts[correctIndex].classList.add('correct');
    opts.forEach((o, i) => { if (i !== chosen && i !== correctIndex) o.classList.add('disabled-grey'); });
    feedback.className = 'feedback wrong-fb show';
    icon.textContent = '✗';
    text.textContent = `Неверно. Правильный ответ: ${correctAnswerText}`;
  }

  document.getElementById('score-label').textContent = `✓ ${score}`;

  if (current < questions.length - 1) {
    btn.className = 'btn-next show';
  } else {
    btn.textContent = 'Завершить тест →';
    btn.className = 'btn-next show';
  }
}

function nextQuestion() {
  current++;
  if (current >= questions.length) {
    showResult();
  } else {
    document.getElementById('question-card').style.animation = 'none';
    setTimeout(() => {
      document.getElementById('question-card').style.animation = '';
      renderQuestion();
    }, 10);
  }
}

function showResult() {
  document.getElementById('quiz-area').style.display = 'none';
  const result = document.getElementById('result-screen');
  result.className = 'result-screen show';

  const pct = Math.round((score / questions.length) * 100);
  document.getElementById('result-circle').style.setProperty('--pct', `${pct}%`);
  document.getElementById('result-score').textContent = `${pct}%`;

  let title, sub;
  if (pct >= 90) { title = 'Отлично!'; sub = `Вы ответили правильно на ${score} из ${questions.length} вопросов.\nПревосходный результат!`; }
  else if (pct >= 70) { title = 'Хорошо!'; sub = `Вы ответили правильно на ${score} из ${questions.length} вопросов.\nХороший результат, есть куда расти.`; }
  else if (pct >= 50) { title = 'Удовлетворительно'; sub = `Вы ответили правильно на ${score} из ${questions.length} вопросов.\nСтоит повторить материал.`; }
  else { title = 'Нужно подготовиться'; sub = `Вы ответили правильно на ${score} из ${questions.length} вопросов.\nРекомендуем изучить тему глубже.`; }

  document.getElementById('result-title').textContent = title;
  document.getElementById('result-sub').textContent = sub;
}

function restartQuiz() {
  current = 0; score = 0;
  document.getElementById('result-screen').className = 'result-screen';
  document.getElementById('quiz-area').style.display = 'block';
  const btnNext = document.getElementById('btn-next');
  btnNext.textContent = 'Следующий вопрос →';
  renderQuestion();
}

renderQuestion();
</script>
<!-- Блок навигации для перехода к любому вопросу -->
<div style="position: fixed; top: 10px; right: 10px; z-index: 1000; background: var(--card); border: 1px solid var(--border); border-radius: 50px; padding: 8px 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); display: flex; gap: 10px; align-items: center; backdrop-filter: blur(5px);">
  <button onclick="goToQuestion(0)" style="background: var(--accent); border: none; color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-weight: bold; font-size: 16px;" title="Первый вопрос">⏮️</button>
  <button onclick="goToQuestion(current - 1)" style="background: var(--surface); border: 1px solid var(--border); color: var(--text); width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-weight: bold; font-size: 16px;" title="Предыдущий вопрос">◀</button>
  
  <div style="display: flex; align-items: center; gap: 5px; background: var(--surface); padding: 3px 10px; border-radius: 40px;">
    <input type="number" id="navInput" min="1" max="122" value="1" style="width: 50px; background: transparent; border: none; color: var(--text); font-family: 'JetBrains Mono'; font-size: 14px; text-align: center; outline: none; border-bottom: 1px solid var(--accent);">
    <span style="color: var(--muted); font-size: 14px;">/ 122</span>
  </div>
  
  <button onclick="goToQuestion(current + 1)" style="background: var(--surface); border: 1px solid var(--border); color: var(--text); width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-weight: bold; font-size: 16px;" title="Следующий вопрос">▶</button>
  <button onclick="goToQuestion(121)" style="background: var(--accent2); border: none; color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-weight: bold; font-size: 16px;" title="Последний вопрос">⏭️</button>
</div>

<!-- Модальное окно для подтверждения перехода -->
<div id="navModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
  <div style="background: var(--card); border: 1px solid var(--border); border-radius: 20px; padding: 30px; max-width: 400px; text-align: center;">
    <div style="font-size: 40px; margin-bottom: 20px;">⚠️</div>
    <h3 style="font-family: 'Unbounded'; margin-bottom: 15px;">Перейти к вопросу <span id="modalQuestionNum"></span>?</h3>
    <p style="color: var(--muted); margin-bottom: 25px;">Текущий прогресс будет сохранён</p>
    <div style="display: flex; gap: 15px; justify-content: center;">
      <button onclick="confirmNavigation()" style="background: linear-gradient(135deg, var(--accent), #9f5ff5); border: none; color: white; padding: 12px 30px; border-radius: 10px; font-family: 'Unbounded'; cursor: pointer; font-weight: 700;">Перейти</button>
      <button onclick="closeModal()" style="background: var(--surface); border: 1px solid var(--border); color: var(--text); padding: 12px 30px; border-radius: 10px; font-family: 'Unbounded'; cursor: pointer; font-weight: 700;">Отмена</button>
    </div>
  </div>
</div>

<script>
// Функция для навигации по вопросам
let targetQuestion = 0;

function goToQuestion(index) {
  const totalQuestions = questions.length;
  
  // Проверка границ
  if (index < 0) index = 0;
  if (index >= totalQuestions) index = totalQuestions - 1;
  
  // Если это вызов с кнопки навигации (не из модального окна)
  if (arguments.length === 1) {
    // Если вопрос уже отвечен и не последний, показываем предупреждение
    if (answered && index !== current) {
      targetQuestion = index;
      document.getElementById('modalQuestionNum').textContent = index + 1;
      document.getElementById('navModal').style.display = 'flex';
      return;
    }
    
    // Просто переходим
    performNavigation(index);
  }
}

function performNavigation(index) {
  if (index < 0 || index >= questions.length) return;
  
  current = index;
  
  // Анимация перехода
  document.getElementById('question-card').style.animation = 'none';
  setTimeout(() => {
    document.getElementById('question-card').style.animation = '';
    renderQuestion();
  }, 10);
  
  // Обновляем значение в поле ввода
  document.getElementById('navInput').value = current + 1;
}

function confirmNavigation() {
  closeModal();
  performNavigation(targetQuestion);
}

function closeModal() {
  document.getElementById('navModal').style.display = 'none';
}

// Обработчик ввода с клавиатуры
document.addEventListener('DOMContentLoaded', function() {
  const navInput = document.getElementById('navInput');
  if (navInput) {
    navInput.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        let val = parseInt(this.value);
        if (isNaN(val)) val = 1;
        if (val < 1) val = 1;
        if (val > questions.length) val = questions.length;
        
        goToQuestion(val - 1);
      }
    });
  }
});

// Добавляем обработчик клавиш для быстрой навигации
document.addEventListener('keydown', function(e) {
  // Alt + ← или Ctrl + ←
  if ((e.altKey || e.ctrlKey) && e.key === 'ArrowLeft') {
    e.preventDefault();
    goToQuestion(current - 1);
  }
  // Alt + → или Ctrl + →
  else if ((e.altKey || e.ctrlKey) && e.key === 'ArrowRight') {
    e.preventDefault();
    goToQuestion(current + 1);
  }
  // Alt + Home или Ctrl + Home
  else if ((e.altKey || e.ctrlKey) && e.key === 'Home') {
    e.preventDefault();
    goToQuestion(0);
  }
  // Alt + End или Ctrl + End
  else if ((e.altKey || e.ctrlKey) && e.key === 'End') {
    e.preventDefault();
    goToQuestion(questions.length - 1);
  }
});
</script>

<style>
/* Стили для поля ввода с браузерными стрелочками */
#navInput::-webkit-outer-spin-button,
#navInput::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
#navInput[type=number] {
  -moz-appearance: textfield;
}

/* Адаптив для мобильных */
@media (max-width: 600px) {
  /* Отступ сверху для контента, чтобы не перекрывало шапку */
  .container {
    margin-top: 70px;
  }
  
  /* Уменьшаем навигацию на мобильных */
  div[style*="position: fixed; top: 10px; right: 10px;"] {
    padding: 5px 10px;
    gap: 5px;
  }
  
  div[style*="position: fixed; top: 10px; right: 10px;"] button {
    width: 32px;
    height: 32px;
    font-size: 14px;
  }
  
  #navInput {
    width: 45px;
    font-size: 13px;
  }
}

/* Для очень маленьких экранов */
@media (max-width: 380px) {
  .container {
    margin-top: 80px;
  }
  
  div[style*="position: fixed; top: 10px; right: 10px;"] button {
    width: 28px;
    height: 28px;
    font-size: 12px;
  }
  
  #navInput {
    width: 40px;
    font-size: 12px;
  }
  
  span[style*="color: var(--muted);"] {
    font-size: 12px;
  }
}
</style>
</body>
</html>
